<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">


<!--
Font-awesome icons ie github or twitter
-->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/brands.css" integrity="sha384-n9+6/aSqa9lBidZMRCQHTHKJscPq6NW4pCQBiMmHdUCvPN8ZOg2zJJTkC7WIezWv" crossorigin="anonymous">

<!--
Google fonts api stuff
-->



<title>hatchR: A toolset to predict when fish hatch and emerge</title>




<style type="text/css">pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */</style>

<style>
@page {
size: 48in 36in;
margin: 0;
padding: 0;
}
body {
margin: 0;
font-size: 45px;
width: 48in;
height: 36in;
padding: 0;
text-align: justify;
font-family: Palatino;
}
.poster_wrap {
width: 48in;
height: 36in;
padding: 0cm;
}
.title_container {
width: 48in;
height: calc(36in * 0.15);
overflow: hidden;
background-color: #011f4b;
border: 0 solid #0b4545;
}
.logo_left {
float: left;
width: 10%;
height: 100%;
background-color: #011f4b;
display: flex;
align-items: center;
justify-content: center;
}
.logo_right {
float: right;
width: 10%;
height: 100%;
background-color: #011f4b;
display: flex;
align-items: center;
justify-content: center;
}
.poster_title {
text-align: center;
position: relative;
float: left;
width: 80%;
height: 100%;
color: #FFFFFF;
top: 50%;
transform: translateY(-50%);
-webkit-transform: translateY(-50%);
}
#title {
font-family: Palatino;
}
/* unvisited link */
a:link {
color: #cc0000;
}
.mybreak {
  break-before: column;
}
/* visited link */
a:visited {
color: #cc0000;
}

/* mouse over link */
a:hover {
color: #cc0000;
}

/* selected link */
a:active {
color: #cc0000;
}
.poster_body {
-webkit-column-count: 4; /* Chrome, Safari, Opera */
-moz-column-count: 4; /* Firefox */
column-count: 4;
-webkit-column-fill: auto;
-moz-column-fill: auto;
column-fill: auto;
-webkit-column-rule-width: 1mm;
-moz-column-rule-width: 1mm;
column-rule-width: 1mm;
-webkit-column-rule-style: dashed;
-moz-column-rule-style: dashed;
column-rule-style: dashed;
-webkit-column-rule-color: #011f4b;
-moz-column-rule-color: #011f4b;
column-rule-color: #011f4b;
column-gap: 1em;
padding-left: 0.5em;
padding-right: 0.5em;
height: 100%;
color: #000000
background-color: #ffffff;
}
.poster_title h1 {
font-size: 75pt;
margin: 0;
border: 0;
font-weight: normal;
}
.poster_body_wrap{
width: calc(48in + 0 + 0);
height: calc(36in * 0.83);
padding-top: calc(36in * 0.005);
padding-bottom: calc(36in * 0.01);
background-color: #ffffff;
}
.poster_title h3 {
color: #ffffff;
font-size: 50pt;
margin: 0;
border: 0;
font-weight: normal;
}
.poster_title h3 > sup {
  font-size: 35pt;
  margin-left: 0.02em;
}
.poster_title h5 {
color: #FFFFFF;
font-size: 35pt;
margin: 0;
border: 0;
font-weight: normal;
}
img {
margin-top: 2cm;
margin-bottom: 0;
}
.section {
  padding: 0.2em;
}
.poster_body h1 {
text-align: center;
color: #FFFFFF;
font-size: 65pt;
border: 2mm solid #005b96;
background-color: #005b96;
border-radius: 4mm 0mm;
margin-top: 2mm;
margin-bottom: 2mm;
font-weight: normal;
}
.poster_body h2 {
color: #000000;
font-size: 40pt;
padding-left: 4mm;
font-weight: normal;
}
.span {
width: 200%;
}
/* center align leaflet map,
from https://stackoverflow.com/questions/52112119/center-leaflet-in-a-rmarkdown-document */
.html-widget {
margin: auto;
position: sticky;
margin-top: 2cm;
margin-bottom: 2cm;
}
.leaflet.html-widget.html-widget-static-bound.leaflet-container.leaflet-touch.leaflet-fade-anim.leaflet-grab.leaflet-touch-drag.leaflet-touch-zoom {
position: sticky;
width: 100%;
}
pre.sourceCode.r {
background-color: #dddddd40;
border-radius: 4mm;
padding: 4mm;
width: 75%;
/* align-items: center; */
margin: auto;
padding-left: 2cm;
}
code.sourceCode.r{
background-color: transparent;
font-size: 20pt;
border-radius: 2mm;
}
.caption {
font-size: 25pt;
}
.table caption {
font-size: 25pt;
padding-bottom: 3mm;

}
code {
font-size: 1em;
font-family: monospace;
background-color: #00808024;
color: #011f4b;
padding: 1.2mm;
border-radius: 2mm;
}
.poster_title code {
font-size: 1em;
}
table {
font-size: 40px;
margin: auto;
border-top: 3px solid #666;
border-bottom: 3px solid #666;
}
table thead th {
border-bottom: 3px solid #ddd;
}
td {
padding: 8px;
}
th {
padding: 15px;
}
caption {
margin-bottom: 10px;
}
.poster_body p {
margin-right: 4mm;
margin-left: 4mm;
margin-top: 6mm;
margin-bottom: 10mm;
}
.poster_body ol {
margin-right: 4mm;
margin-left: 4mm;
}
#ul {
margin-right: 4mm;
margin-left: 4mm;
}
.references p {
font-size: 20pt;
}
.orcid img {
  width: 1em;
}
</style>
</head>
<body>


<div class="poster_wrap">
<div class="title_container">
<!-- Left Logo  -->
<div class="logo_left">
<img src= 'hatchR_posterdown_files/figure-html/logo.png' style="width: 80%">
</div>
<!-- Poster Title -->
<div class= "poster_title">
<h1 id="title">hatchR: A toolset to predict when fish hatch and emerge</h1>
<h3 id="author">Morgan Sparks<sup>1</sup>, Eli Felts<sup>2</sup>, Allison Swartz<sup>3</sup>, Bryan Maitland<sup>1</sup></h3><br>
<h5 id="affiliation"><sup>1</sup> Rocky Mountain Research Station, US Forest Service<br> <sup>2</sup> Idaho Fish and Wildlife Conservation Oﬀice, US Fish and Wildlife Service<br> <sup>3</sup> College of Forestry, Oregon State University</h5>
</div>
<!-- Right Logo  -->
<div class="logo_right">
<img src=./hatchR_posterdown_files/figure-html/agency_logos.png style="width: 80%">
</div>
</div>

<div class='poster_body_wrap'>
<div class='poster_body'>
<div id="hatchr" class="section level1">
<h1>hatchR</h1>
<p><strong>hatchR</strong> is a software ecosystem for predicting fish developmental phenology using statistical models. It offers three primary applications:</p>
<ol style="list-style-type: decimal">
<li>Basic summarization, plotting, and data checks for water temperature data.</li>
<li>Access published parameterizations for salmonid developmental models or build your own custom parameterizations for any species with user provided data.</li>
<li>Predict hatch and/or emergence timing across ambient temperatures from common data sources such as HOBO loggers.</li>
</ol>
<p><strong>hatchR</strong> is deployed in two formats. First, it can be downloaded as a R package. Secondly, for users not familiar with R, it can also be accessed as a web app built in Shiny as a point-and-click tool.</p>
<p>To predict phenology, you need <u><strong>daily average temperatures over incubation (or data that can be summarized as such</strong></u><strong>)</strong> and <u><strong>spawn timing</strong></u>.</p>
</div>
<div id="hatchrs-workflow" class="section level1">
<h1>hatchR’s workflow</h1>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="hatchR_posterdown_files/figure-html/workflow.png" alt="hatchR workflow. Processes are presented as filled circles, functions as plain text rectangles, and decisions as italicized text." width="36%" />
<p class="caption">
Figure 1: hatchR workflow. Processes are presented as filled circles, functions as plain text rectangles, and decisions as italicized text.
</p>
</div>
</div>
<div id="included-custom-models" class="section level1">
<h1>Included &amp; custom models</h1>
<p><strong>hatchR</strong> includes numerous parameterizations for salmonids because the original models were built from aquaculture studies with salmon. Those models are included in <code>model_table</code> and include all North American Pacific Salmon (<em>Oncorhynchus spp.</em>) and Bull Trout (<em>Salvelinus confluentus</em>).</p>
<table>
<caption>
<span id="tab:mytable">Table 1: </span>Two example rows (of 51) from <code>model_table</code>.
</caption>
<thead>
<tr>
<th style="text-align:center;">
author
</th>
<th style="text-align:center;">
species
</th>
<th style="text-align:center;">
expression
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Beacham and Murray 1990
</td>
<td style="text-align:center;">
sockeye
</td>
<td style="text-align:center;">
1 /exp(6.727 - log(x + 2.394))
</td>
</tr>
<tr>
<td style="text-align:center;">
Beacham and Murray 1990
</td>
<td style="text-align:center;">
pink odd
</td>
<td style="text-align:center;">
1 / exp(6.663 - log(x + 2.557))
</td>
</tr>
</tbody>
</table>
<p>Alternatively, you can build custom models with experimental data. Here we demonstrate with Channel Catfish (<em>Ictalurus punctatus</em>).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># make catfish data object for function</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>catfish <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="dv">3</span>, <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">data.frame</span>() </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">colnames</span>(catfish) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;days&quot;</span>, <span class="st">&quot;temp_C&quot;</span>) </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>catfish<span class="sc">$</span>days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">21</span>,<span class="dv">26</span>) <span class="co"># days to hatch</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>catfish<span class="sc">$</span>temp_C <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">10</span>,<span class="dv">7</span>) <span class="co"># exp. temperatures</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>cat_mod <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">temp =</span> catfish<span class="sc">$</span>temp_C, </span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="at">days =</span> catfish<span class="sc">$</span>days,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">&quot;catfish&quot;</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="at">development_type =</span> <span class="st">&quot;hatch&quot;</span>)</span></code></pre></div>
<p>To further demonstrate this approach we parameterize models (not shown) for Smallmouth Bass (<em>Micropterus dolomieu</em>) and Lake Sturgeon (<em>Acipenser fulvescens</em>) and apply the models to a temperature regime with mean temperature 16 °C.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="hatchR_posterdown_files/figure-html/unnamed-chunk-3-1.png" alt="Predicted days to hatch using custom parameterizations for three warmwater species with mean 16 °C thermal regime." width="75%" />
<p class="caption">
Figure 2: Predicted days to hatch using custom parameterizations for three warmwater species with mean 16 °C thermal regime.
</p>
</div>
</div>
<div id="basic-prediction" class="section level1">
<h1>Basic prediction</h1>
<p>As a case study for a basic application we’ll use our included data set of <code>crooked_river</code> and an example with Bull Trout.</p>
<p>Let’s assume the forest manager wants to do some roadwork upstream of a Bull Trout spawning reach in Crooked River starting <strong>July 1</strong>. They engage the forest biologist who knows Bull Trout, which are sensitive to sediment, will be finished spawning there by <strong>September 30</strong>. They can then predict if fish are likely to have emerged from the gravel by July (using the 2014-2015 spawn year).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># get model from model_table</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>bull_trout_emerge <span class="ot">&lt;-</span> <span class="fu">model_select</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">author =</span> <span class="st">&quot;Austin et al. 2017&quot;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">species =</span> <span class="st">&quot;bull trout&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">model =</span> <span class="st">&quot;MM&quot;</span>,</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">development_type =</span> <span class="st">&quot;emerge&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># predict phenology assuming Sept. 30th as spawn</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>crooked_river_emerge <span class="ot">&lt;-</span> <span class="fu">predict_phenology</span>(</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="at">data =</span> crooked_river, </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="at">dates =</span> date, </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  <span class="at">temperature =</span> temp_c, </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="at">spawn.date =</span> <span class="st">&quot;2014-09-30&quot;</span>, </span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="at">model =</span> bull_trout_emerge) </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#predicted days to emerge</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>crooked_river_emerge<span class="sc">$</span>days_to_develop</span></code></pre></div>
<pre><code>## [1] 204</code></pre>
<p>Our model predicts Bull Trout will emerge 204 days after September 30th, which is April 22 or well before the July 1 date of road construction.</p>
</div>
<div id="advanced-prediction" class="section level1">
<h1>Advanced prediction</h1>
<p>The power of <strong>hatchR</strong> is fully realized when we combine multiple variables for iterating the <strong>hatchR</strong> function, <code>predict_phenology()</code>. We’ll use 139 putative Bull Trout populations spread across Idaho to demonstrate combining predictions across sites, years, and spawn dates. We will use the included <code>idaho</code> data set, with which we will do some filtering (not shown) and then predict hatch timing assuming fish spawn September 1, 15, and 30 (Early, Peak, Late) at each site in each of the four continuous years of temperature data (1668 parameter combinations).</p>
<p>We present an abridged demonstration automating across our parameter set:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># predict hatch time across variable combinations</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>hatch_res <span class="ot">&lt;-</span> isaak_summ_bt <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dev_period =</span> <span class="fu">map2</span>(</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>      summ_obj, spawn_dates, </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>      predict_phenology,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>      <span class="at">temperature =</span> daily_temp,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>      <span class="at">model =</span> bt_hatch,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>      <span class="at">dates =</span> date) <span class="sc">|&gt;</span> </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>      <span class="fu">map_df</span>(<span class="st">&quot;dev.period&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>      <span class="fu">list</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="fu">select</span>(site, dev_period) <span class="sc">|&gt;</span> </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(dev_period)) <span class="sc">|&gt;</span> </span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days_to_hatch =</span> stop <span class="sc">-</span> start) </span></code></pre></div>
<p>We can then plot those results (code not shown) to visualize phenology across our variable set.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="hatchR_posterdown_files/figure-html/unnamed-chunk-7-1.png" alt="Predicted hatch timing for 139 putatuve Bull Trout sites for three spawning periods." width="672" />
<p class="caption">
Figure 3: Predicted hatch timing for 139 putatuve Bull Trout sites for three spawning periods.
</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p><strong>hatchR</strong> includes extensive documentation for these and other examples. To fully explore <strong>hatchR</strong> or try out the <strong>Basic prediction</strong> example in Shiny (<em>scroll pages down on mobile devices</em>), we recommend visiting the Shiny and package websites.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="hatchR_posterdown_files/figure-html/hatchR_shiny.png" alt="Shiny App (left), Website (Right)" width="11%" height="11%" /><img src="hatchR_posterdown_files/figure-html/hatchR_website.png" alt="Shiny App (left), Website (Right)" width="11%" height="11%" />
<p class="caption">
Figure 4: Shiny App (left), Website (Right)
</p>
</div>
</div>
</div>
</div>

</div>



</body>
</html>
