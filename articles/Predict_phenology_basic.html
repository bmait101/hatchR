<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Predict fish phenology: basic • hatchR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict fish phenology: basic">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hatchR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction to hatchR</h6></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Parameterize_models.html">Parameterize hatchR Models</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_basic.html">Predict fish phenology: basic</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_spawning.html">Predict spawning</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced hatchR</h6></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_advanced.html">Predict fish phenology: advanced</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_nested.html">Predict fish phenology: nested</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_plotting.html">Advanced plotting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Shiny App</h6></li>
    <li><a class="dropdown-item" href="../articles/Shiny_app.html">Launching Shiny</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other use cases</h6></li>
    <li><a class="dropdown-item" href="../articles/Non-fish.html">Non-fish examples</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model Bibliography</h6></li>
    <li><a class="dropdown-item" href="../articles/Model_bibliography.html">Model bibliography</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bmait101/hatchR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Predict fish phenology: basic</h1>
                        <h4 data-toc-skip class="author">Morgan Sparks,
Bryan M. Maitland</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bmait101/hatchR/blob/master/vignettes/Predict_phenology_basic.Rmd" class="external-link"><code>vignettes/Predict_phenology_basic.Rmd</code></a></small>
      <div class="d-none name"><code>Predict_phenology_basic.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>This vignette demonstrates a complete and simple
<strong>hatchR</strong> workflow. We will use data installed with the
package from Woody Island in Lake Iliamna, Alaska <span class="citation">(Sparks et al. 2019)</span>, to predict the hatch and
emergence timing of sockeye salmon (<em>Oncorhynchus nerka</em>).</p>
<p>If you have not already done so, see the vignettes on <a href="https://bmait101.github.io/hatchR/articles/Introduction.html">data
checks</a> and <a href="https://bmait101.github.io/hatchR/articles/Parameterize_models.html">model
parameterization</a>.</p>
<p>Additionally, <code><a href="../reference/predict_phenology.html">predict_phenology()</a></code> has a companion
function, <code><a href="../reference/predict_spawn.html">predict_spawn()</a></code>, which works in the backwards
direction of <code><a href="../reference/predict_phenology.html">predict_phenology()</a></code>. It allows users to
predict spawn timing starting from known hatch or emergence timing—you
can read more about it in the <a href="https://bmait101.github.io/hatchR/articles/Predict_spawning.html">Predict
spawning</a> vignette.</p>
<p>First, we load needed packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bmait101.github.io/hatchR/">hatchR</a></span><span class="op">)</span>    <span class="co"># for phenology modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>   <span class="co"># for additional plotting options</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span> <span class="co"># for date manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>    <span class="co"># for tidy tibbles and data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>     <span class="co"># for data manipulation</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-checks">Data checks<a class="anchor" aria-label="anchor" href="#data-checks"></a>
</h3>
<p>First, let’s check the data to make sure it’s in the right format.
We’ll print the first few rows and <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to get a sense
of the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">woody_island</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 735 × 2</span></span></span>
<span><span class="co">#&gt;   date       temp_c</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1990-08-11   25.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1990-08-12   23.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1990-08-13   18.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1990-08-14   15.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1990-08-15   14.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 730 more rows</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">woody_island</span><span class="op">)</span></span>
<span><span class="co">#&gt;       date                temp_c      </span></span>
<span><span class="co">#&gt;  Min.   :1990-08-11   Min.   :-9.900  </span></span>
<span><span class="co">#&gt;  1st Qu.:1991-02-10   1st Qu.: 1.733  </span></span>
<span><span class="co">#&gt;  Median :1991-08-13   Median : 4.442  </span></span>
<span><span class="co">#&gt;  Mean   :1991-08-13   Mean   : 5.272  </span></span>
<span><span class="co">#&gt;  3rd Qu.:1992-02-12   3rd Qu.: 7.767  </span></span>
<span><span class="co">#&gt;  Max.   :1992-08-14   Max.   :28.700</span></span></code></pre></div>
<p>You can see that each day already is summarized as a mean
temperature. You can also see that the data spans multiple years. We’ll
use <code><a href="../reference/plot_check_temp.html">plot_check_temp()</a></code> to make visually check the data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_check_temp.html">plot_check_temp</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">woody_island</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="Predict_phenology_basic_files/figure-html/plot-1.png" width="576" style="display: block; margin: auto;"></p>
<p>There appear to be outliers in the data, specifically in the very
beginning and end of the period of record, and right in the middle. The
loggers look to have been recording observations outside of the water
and then in the middle where the water level may have dropped and
exposed it to the air.</p>
<p>However, spawning in this system typically peaks around August 18 and
hatching and emergence are done before the start of the following
spawning season, so we can predict phenology within a subset of a year.
Because <code><a href="../reference/plot_check_temp.html">plot_check_temp()</a></code> is a <strong>ggplot2</strong>
object, we can add additional plotting elements to the graph to
represent the approximate phenology window:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      xmin <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"1990-08-18"</span><span class="op">)</span>,</span>
<span>      xmax <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"1991-04-01"</span><span class="op">)</span>,</span>
<span>      ymin <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, </span>
<span>      ymax <span class="op">=</span> <span class="fl">25</span></span>
<span>    <span class="op">)</span>, </span>
<span>    fill <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.01</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Predict_phenology_basic_files/figure-html/plot-rect-1.png" width="576" style="display: block; margin: auto;"></p>
<p>If we just apply the model within the gray polygon we’ve drawn, the
model should work just fine.</p>
</div>
<div class="section level3">
<h3 id="model-select">Model select<a class="anchor" aria-label="anchor" href="#model-select"></a>
</h3>
<p>Now that our temperature data is usable, we can select our models.
We’ll predict both hatch and emergence, so we will obtain a model
expression for each using <code><a href="../reference/model_select.html">model_select()</a></code>. The only argument
in <code><a href="../reference/model_select.html">model_select()</a></code> that must be changed in this case is
<code>development_type</code>, which can be either “hatch” or
“emerge”.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sockeye_hatch_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>  author <span class="op">=</span> <span class="st">"Beacham and Murray 1990"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"sockeye"</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  development_type <span class="op">=</span> <span class="st">"hatch"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sockeye_emerge_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>  author <span class="op">=</span> <span class="st">"Beacham and Murray 1990"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"sockeye"</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  development_type <span class="op">=</span> <span class="st">"emerge"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Let’s look at the model specifications for the two different
parameterizations we’ve selected:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sockeye_hatch_mod</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   author                  species model_id development_type expression          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Beacham and Murray 1990 sockeye 2        hatch            1 /exp(6.727 - log(…</span></span>
<span><span class="va">sockeye_emerge_mod</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   author                  species model_id development_type expression          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Beacham and Murray 1990 sockeye 2        emerge           1 / exp(7.227 - log…</span></span></code></pre></div>
<p>You can see they are parameterized slightly different to account for
the differences between hatch and emergence timing.</p>
</div>
<div class="section level3">
<h3 id="predict-phenology">Predict phenology<a class="anchor" aria-label="anchor" href="#predict-phenology"></a>
</h3>
<p>We can now use our model expressions to predict when sockeye would
hatch and emerge at Woody Island in 1990. First we predict hatch timing
using <code><a href="../reference/predict_phenology.html">predict_phenology()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WI_hatch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">woody_island</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>  spawn.date <span class="op">=</span> <span class="st">"1990-08-18"</span>,</span>
<span>  model <span class="op">=</span> <span class="va">sockeye_hatch_mod</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BBBB00;">!</span> Fish developed, but negative temperature values resulted in NaNs after</span></span>
<span><span class="co">#&gt;   development.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Check date(s): 1991-08-12</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Fish spawn date was: 1990-08-18</span></span></code></pre></div>
<blockquote>
<p>Note the warning message that appears when you run this code for
<code>woody_island</code>. It reveals that while the fish developed,
negative temperature values resulted in <code>NaN</code>s after
development. More on this in the <span id="neg_temp">Negative
Temperature</span> section.</p>
</blockquote>
<p>Next, look inside the returned object to see days to hatch and
development period (more on this in the <a href="#results">Understanding
your results</a> section)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WI_hatch</span><span class="op">$</span><span class="va">days_to_develop</span></span>
<span><span class="co">#&gt; [1] 74</span></span>
<span><span class="va">WI_hatch</span><span class="op">$</span><span class="va">dev_period</span></span>
<span><span class="co">#&gt;        start       stop</span></span>
<span><span class="co">#&gt; 1 1990-08-18 1990-10-30</span></span></code></pre></div>
<p>We can also do the same with emergence:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WI_emerge</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">woody_island</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>  spawn.date <span class="op">=</span> <span class="st">"1990-08-18"</span>,</span>
<span>  model <span class="op">=</span> <span class="va">sockeye_emerge_mod</span> <span class="co"># notice we're using emerge model expression here</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: <span style="color: #BBBB00;">!</span> Fish developed, but negative temperature values resulted in NaNs after</span></span>
<span><span class="co">#&gt;   development.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Check date(s): 1991-08-12</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Fish spawn date was: 1990-08-18</span></span>
<span></span>
<span><span class="va">WI_emerge</span><span class="op">$</span><span class="va">days_to_develop</span></span>
<span><span class="co">#&gt; [1] 204</span></span>
<span><span class="va">WI_emerge</span><span class="op">$</span><span class="va">dev_period</span></span>
<span><span class="co">#&gt;        start       stop</span></span>
<span><span class="co">#&gt; 1 1990-08-18 1991-03-09</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results">Understanding your results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>The output from <code><a href="../reference/predict_phenology.html">predict_phenology()</a></code> includes a lot of
information. Here is a summary of the elements in the output list.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">WI_hatch</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 Length Class       Mode   </span></span>
<span><span class="co">#&gt; days_to_develop 1      -none-      numeric</span></span>
<span><span class="co">#&gt; dev_period      2      data.frame  list   </span></span>
<span><span class="co">#&gt; ef_table        5      tbl_df      list   </span></span>
<span><span class="co">#&gt; model_specs     5      spec_tbl_df list</span></span></code></pre></div>
<p>We can access each element using the <code>$</code> operator:</p>
<ul>
<li><p><code>WI_hatch$days_to_develop</code> outputs the predicted days
to hatch or emerge.</p></li>
<li><p><code>WI_hatch$dev_period</code> is a 1x2 dataframe with the
dates corresponding to when your fish’s parent spawned (which you input
with <code>predict_phenology(spawn.date = ...)</code>) and the date when
the fish is predicted to hatch or emerge.</p></li>
<li><p><code>WI_hatch$ef_table</code> is a <em>n</em> x 5 tibble
(<em>n</em> = number of days to hatch or emerge) and the columns are a
row index, the date, each day’s temperature, effective value, and the
cumulative sum of the effective values to that date. The
<code>ef_table</code> object is meant to serve as the basis for users to
make custom figures for their data beyond the functionality we discuss
below.</p></li>
<li><p><code>WI_hatch$model_specs</code> is a tibble showing the model
specifications used to predict the phenology.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="visualizing-phenology">Visualizing phenology<a class="anchor" aria-label="anchor" href="#visualizing-phenology"></a>
</h3>
<p><strong>hatchR</strong> has a built in function,
<code><a href="../reference/plot_phenology.html">plot_phenology()</a></code>, that allows users to visualize their
phenology results. The plot visualizes three specific components:</p>
<ol style="list-style-type: decimal">
<li>the temperature regime over which you are predicting</li>
<li>the cumulative sum of effective values</li>
<li>the effective value for each day in your prediction span</li>
</ol>
<p>The function allows you to output various figures based on your
interests, but defaults to a figure with all information and lots of
labeling.</p>
<p>In the output of <code><a href="../reference/plot_phenology.html">plot_phenology()</a></code> the <em>cumulative
effective values</em> are scaled by the warmest temperature in
<code>ef_table</code> and the <em>daily effective values</em> are scaled
by multiplying by 100 so everything is visibly congruent in the
figure.</p>
<p>Let’s look at the basic call, which gives you all the
information:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phenology.html">plot_phenology</a></span><span class="op">(</span><span class="va">WI_hatch</span><span class="op">)</span></span></code></pre></div>
<p><img src="Predict_phenology_basic_files/figure-html/plot-pheno-1.png" width="576" style="display: block; margin: auto;"></p>
<p>You can turn of labeling or plot specific values using the function
arguments <code>style</code> and <code>labels</code>, for example (plots
not rendered):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># shows a plot with just the ef cumulative sum values</span></span>
<span><span class="fu"><a href="../reference/plot_phenology.html">plot_phenology</a></span><span class="op">(</span><span class="va">WI_hatch</span>, style <span class="op">=</span> <span class="st">"ef_cumsum"</span><span class="op">)</span></span>
<span><span class="co"># shows a plot with just the ef daily values</span></span>
<span><span class="fu"><a href="../reference/plot_phenology.html">plot_phenology</a></span><span class="op">(</span><span class="va">WI_hatch</span>, style <span class="op">=</span> <span class="st">"ef_daily"</span><span class="op">)</span> </span>
<span><span class="co"># turns off the labeling for a cleaner figure</span></span>
<span><span class="fu"><a href="../reference/plot_phenology.html">plot_phenology</a></span><span class="op">(</span><span class="va">WI_hatch</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="negtemps">A note about negative temperatures<a class="anchor" aria-label="anchor" href="#negtemps"></a>
</h3>
<p>Occasionally, temperature data sets will have a few negative values
or values very close to 0. Negative numbers below a certain threshold
will output “not a number” (<code>NaN</code>) effective values because
they are undefined in the model expression and will break the function.
Similarly, even negative values above that threshold will produce very
small effective values. Because these values are so small, we allow the
model to accumulate them even though development below 0 is biologically
unlikely. We <strong>assume</strong> your data set has been checked for
these values and doesn’t include long periods of freezing, however the
model allows for the occasional dip below freezing because the effect is
so negligible toward development over incubation.</p>
<p>A toy example of this phenomenon is shown below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vector of temps from -5 to 15 by 0.5</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, to <span class="op">=</span> <span class="fl">15</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;  [1] -5.0 -4.5 -4.0 -3.5 -3.0 -2.5 -2.0 -1.5 -1.0 -0.5  0.0  0.5  1.0  1.5  2.0</span></span>
<span><span class="co">#&gt; [16]  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0  7.5  8.0  8.5  9.0  9.5</span></span>
<span><span class="co">#&gt; [31] 10.0 10.5 11.0 11.5 12.0 12.5 13.0 13.5 14.0 14.5 15.0</span></span>
<span></span>
<span><span class="co"># get effective values for those temperatures</span></span>
<span><span class="co"># You can see the NaN warning that shows up in our past applications</span></span>
<span><span class="va">demo_ef_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">sockeye_hatch_mod</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demo_ef_vals</span></span>
<span><span class="co">#&gt;  [1]         NaN         NaN         NaN         NaN         NaN         NaN</span></span>
<span><span class="co">#&gt;  [7] 0.000472060 0.001071121 0.001670182 0.002269243 0.002868304 0.003467365</span></span>
<span><span class="co">#&gt; [13] 0.004066426 0.004665487 0.005264548 0.005863609 0.006462670 0.007061731</span></span>
<span><span class="co">#&gt; [19] 0.007660792 0.008259853 0.008858914 0.009457975 0.010057036 0.010656097</span></span>
<span><span class="co">#&gt; [25] 0.011255157 0.011854218 0.012453279 0.013052340 0.013651401 0.014250462</span></span>
<span><span class="co">#&gt; [31] 0.014849523 0.015448584 0.016047645 0.016646706 0.017245767 0.017844828</span></span>
<span><span class="co">#&gt; [37] 0.018443889 0.019042950 0.019642011 0.020241072 0.020840133</span></span>
<span></span>
<span><span class="co"># bring together as a tibble</span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">demo_ef_vals</span><span class="op">)</span></span>
<span><span class="va">demo</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 41 × 2</span></span></span>
<span><span class="co">#&gt;       x demo_ef_vals</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  -<span style="color: #BB0000;">5</span>            <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  -<span style="color: #BB0000;">4.5</span>          <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  -<span style="color: #BB0000;">4</span>            <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  -<span style="color: #BB0000;">3.5</span>          <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  -<span style="color: #BB0000;">3</span>            <span style="color: #BB0000;">NaN</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 36 more rows</span></span></span>
<span></span>
<span><span class="co"># plot (note NaNs are removed from figure)</span></span>
<span><span class="co"># rectangle added to highlight the approximate temperatures of interest</span></span>
<span><span class="va">demo</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">demo_ef_vals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>      xmin <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, xmax <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"dodgerblue"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Temperature (C)"</span>, y <span class="op">=</span> <span class="st">"Effective Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Predict_phenology_basic_files/figure-html/temp-example-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-sparks2019" class="csl-entry">
Sparks, Morgan M., Jeffrey A. Falke, Thomas P. Quinn, Milo D. Adkison,
Daniel E. Schindler, Krista Bartz, Dan Young, and Peter A. H. Westley.
2019. <span>“Influences of Spawning Timing, Water Temperature, and
Climatic Warming on Early Life History Phenology in Western Alaska
Sockeye Salmon.”</span> <em>Canadian Journal of Fisheries and Aquatic
Sciences</em> 76 (1): 123–35. <a href="https://doi.org/10.1139/cjfas-2017-0468" class="external-link">https://doi.org/10.1139/cjfas-2017-0468</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bryan M. Maitland, Morgan M. Sparks.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
