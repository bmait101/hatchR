<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Parameterize hatchR Models • hatchR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parameterize hatchR Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hatchR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction to hatchR</h6></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Parameterize_models.html">Parameterize hatchR Models</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_basic.html">Predict fish phenology: basic</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced hatchR</h6></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_advanced.html">Predict fish phenology: advanced</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_nested.html">Predict fish phenology: nested</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced_plotting.html">Advanced plotting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Shiny App</h6></li>
    <li><a class="dropdown-item" href="../articles/Shiny_app.html">Launching Shiny</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Model Bibliography</h6></li>
    <li><a class="dropdown-item" href="../articles/Model_bibliography.html">Model bibliography</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bmait101/hatchR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Parameterize hatchR Models</h1>
                        <h4 data-toc-skip class="author">Morgan Sparks,
Bryan M. Maitland</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bmait101/hatchR/blob/master/vignettes/Parameterize_models.Rmd" class="external-link"><code>vignettes/Parameterize_models.Rmd</code></a></small>
      <div class="d-none name"><code>Parameterize_models.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette describes two options for selecting parameterized
models for predicting fish early life history phenology using
<strong>hatchR</strong>:</p>
<ol style="list-style-type: decimal">
<li>model parameterizations included in the package</li>
<li>custom parameterizations using your own data (i.e., days to hatch or
emerge and average incubation temperature)</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bmait101.github.io/hatchR/">hatchR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="built-in-parameterizations">Built-in parameterizations<a class="anchor" aria-label="anchor" href="#built-in-parameterizations"></a>
</h2>
<p>Published model parameterizations are contained in the
<code>model_table</code> object. This includes parameterizations for
several salmonid species from hatchery studies relating temperature to
hatch and emergence timing <span class="citation">Sparks et al.
(2019)</span>, and can be selected using
<code><a href="../reference/model_select.html">hatchR::model_select()</a></code>.</p>
<p>These models are parameterized to 50% hatch or emergence (see <span class="citation">Velsen (1987)</span> for details). It is important to
remember that while these models predict a point estimate, hatch and
emergence, even within a single spawning family would occur as a
distribution of the phenological event.</p>
<div class="section level3">
<h3 id="model_table">
<code>model_table</code><a class="anchor" aria-label="anchor" href="#model_table"></a>
</h3>
<p><code>model_table</code> is loaded with <strong>hatchR</strong>, and
is a tibble with 51 rows and 5 columns:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_table</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 51 × 5</span></span></span>
<span><span class="co">#&gt;   author                  species model_id development_type expression          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Beacham and Murray 1990 sockeye 2        hatch            1 /exp(6.727 - log(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Beacham and Murray 1990 sockeye 4        hatch            1/exp(8.734 + (-1.5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Beacham and Murray 1990 sockeye 5        hatch            1/exp(9.848 + (-1.5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Beacham and Murray 1990 sockeye 7        hatch            1/exp(5.379 + (-0.0…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Beacham and Murray 1990 sockeye 2        emerge           1 / exp(7.227 - log…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 46 more rows</span></span></span></code></pre></div>
<ul>
<li>
<code>author</code>: author-date key denoting publication containing
the model parameterization</li>
<li>
<code>species</code>: the species the model is parameterized
for</li>
<li>
<code>model</code>: the model ID (if multiple model
parameterizations were built (<em>e.g.</em>, <span class="citation">Beacham and Murray (1990)</span>)</li>
<li>
<code>development_type</code>: the phenological development type
(<em>i.e.</em>, hatch or emerge)</li>
<li>
<code>expression</code>: a character string defining the model
parameterization</li>
</ul>
</div>
<div class="section level3">
<h3 id="model_select">
<code>model_select()</code><a class="anchor" aria-label="anchor" href="#model_select"></a>
</h3>
<p>Combinations of <code>author</code>, <code>species</code>,
<code>model</code>, and <code>development_type</code> are unique and
used to select parameterized model expressions. For instance, if you
wanted to access the expression for sockeye salmon (<em>Oncorhynchus
nerka</em>) hatch phenology using model #2 from <span class="citation">Beacham and Murray (1990)</span>, you would run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sockeye_hatch_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>  author <span class="op">=</span> <span class="st">"Beacham and Murray 1990"</span>, </span>
<span>  species <span class="op">=</span> <span class="st">"sockeye"</span>, </span>
<span>  model <span class="op">=</span> <span class="fl">2</span>, </span>
<span>  development_type <span class="op">=</span> <span class="st">"hatch"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">sockeye_hatch_mod</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">#&gt;   author                  species model_id development_type expression          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Beacham and Murray 1990 sockeye 2        hatch            1 /exp(6.727 - log(…</span></span></code></pre></div>
<p>Note, that the above arguments are equivalent to the first line and
four columns from <code>model_table</code>. Your model function
object—in this case <code>sockeye_hatch_mod</code>—can then be passed to
<code><a href="../reference/predict_phenology.html">predict_phenology()</a></code>, which we will demonstrate in the <a href="https://bmait101.github.io/hatchR/articles/Predict_phenology_basic.html">Predict
Phenology: Basic</a> vignette.</p>
<p>To see all available characterizations use:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">model_table</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-custom-models">Creating custom models<a class="anchor" aria-label="anchor" href="#creating-custom-models"></a>
</h2>
<p><strong>hatchR</strong> also includes basic functionality to generate
your own model parameterizations for predicting hatching and emergence
phenology using your own data. <strong>Importantly</strong>, this
functionality implements <strong><em>model form #2</em></strong> of
<span class="citation">Beacham and Murray (1990)</span>, which we chose
because of its overall simplicity and negligible loss of accuracy. See
<span class="citation">Beacham and Murray (1990)</span> and <span class="citation">Sparks et al. (2019)</span> for more specific
discussion regarding model #2 and the development of the effective value
approach.</p>
<p>The model follows the general format of:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mi>e</mi></msub><mi>a</mi><mo>−</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mi>e</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mi>e</mi><mi>m</mi><mi>p</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><msub><mi>e</mi><mi>i</mi></msub><mo>−</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Effective Value_i = 1/exp(log_ea - log_e(Temperature_i - b))
</annotation></semantics></math></p>
<p>Where <em>i</em> is the daily value and a fish hatches or emerges
when the cumulative sum reaches one:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>E</mi><mi>f</mi><mi>f</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i =1}^nEffectiveValue_i = 1</annotation></semantics></math></p>
<div class="section level3">
<h3 id="fit_model">
<code>fit_model()</code><a class="anchor" aria-label="anchor" href="#fit_model"></a>
</h3>
<p>The function <code><a href="../reference/fit_model.html">fit_model()</a></code> uses data in which average
incubation temperature (°C) and days to phenological event are the
inputs and estimates parameter coefficients for
<em>log<sub>e</sub>a</em> and <em>b</em> using
<code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>.</p>
<p>Here, we borrow data from Table 8.1 (pg. 183) from <span class="citation">Quinn (2018)</span> to generate a custom hatch
parameterization for brown trout (<em>Salmo trutta</em>).</p>
<p>You could either create a .csv file with those data and import them
with <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> or alternatively, directly input
them as an object in R. We’ll use <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble()</a></code> to
create the data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">11</span>,<span class="fl">14</span><span class="op">)</span>, </span>
<span>  days_to_hatch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">194</span>,<span class="fl">87</span>,<span class="fl">54</span>,<span class="fl">35</span>,<span class="fl">28</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">bt_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   temperature days_to_hatch</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>           2           194</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>           5            87</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>           8            54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>          11            35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>          14            28</span></span></code></pre></div>
<p>We can plot our data for a validity check using
<strong>ggplot2</strong>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">temperature</span>, y <span class="op">=</span> <span class="va">days_to_hatch</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Parameterize_models_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>We can now use <code><a href="../reference/fit_model.html">fit_model()</a></code> to create our custom
parameterization from our data. You must specify a species and a
development type, information which is carried forward in subsequent
functions in <strong>hatchR</strong>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">bt_data</span><span class="op">$</span><span class="va">temperature</span>, </span>
<span>                    days <span class="op">=</span> <span class="va">bt_data</span><span class="op">$</span><span class="va">days_to_hatch</span>, </span>
<span>                    species <span class="op">=</span> <span class="st">"brown_trout"</span>, </span>
<span>                    development_type <span class="op">=</span> <span class="st">"hatch"</span><span class="op">)</span></span></code></pre></div>
<p>The output of <code><a href="../reference/fit_model.html">fit_model()</a></code> is a list with several
elements:</p>
<ul>
<li>
<code>bt_fit$model</code>: a model object of class “nls” containing
the nonlinear regression model</li>
<li>
<code>bt_fit$log_a</code>: a named numeric vector of the estimated
coefficient <em>log<sub>e</sub>a</em>
</li>
<li>
<code>bt_fit$b</code>: a named numeric vector of the estimated
coefficient <em>b</em>
</li>
<li>
<code>bt_fit$r_squared</code>: pseudo R-squared value (1 - (residual
sum of squares / total sum of squares))</li>
<li>
<code>bt_fit$mse</code>: mean squared error (mean(residuals^2))</li>
<li>
<code>bt_fit$rmse</code>: root mean squared error (sqrt(mse)</li>
<li>
<code>bt_fit$expression</code>: a tibble with the species,
development type, and the parameterized model expression</li>
<li>
<code>bt_fit$pred_plot</code>: a ggplot object showing the observed
data and predicted values</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_fit</span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: y ~ a/(x - b)</span></span>
<span><span class="co">#&gt;    data: df</span></span>
<span><span class="co">#&gt;        a        b </span></span>
<span><span class="co">#&gt; 439.1634  -0.2582 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 36.92</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 5 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 2.062e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $log_a</span></span>
<span><span class="co">#&gt; [1] 6.084872</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $b</span></span>
<span><span class="co">#&gt; [1] -0.2582361</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $r_squared</span></span>
<span><span class="co">#&gt; [1] 0.9979987</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mse</span></span>
<span><span class="co">#&gt; [1] 7.38454</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rmse</span></span>
<span><span class="co">#&gt; [1] 2.717451</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $expression</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   species     development_type expression                                       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> brown_trout hatch            1 / exp(6.08487164651134 - log(x + 0.25823605907…</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pred_plot</span></span></code></pre></div>
<p><img src="Parameterize_models_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The vast majority of the time, what you will want is the actual
expression with parameter estimates for use in the
<code>model = ...</code> argument of <code><a href="../reference/predict_phenology.html">predict_phenology()</a></code>.
This is stored in the <code>expression</code> element of the list.</p>
<p>You can either pass this tibble directly with the <code>$</code>
operator by calling <code>$expression</code> element of the list (e.g.,
<code>model = bt_fit$expression</code>) or set as an object to pass,
like so:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_hatch_exp</span> <span class="op">&lt;-</span> <span class="va">bt_fit</span><span class="op">$</span><span class="va">expression</span></span>
<span><span class="va">bt_hatch_exp</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   species     development_type expression                                       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> brown_trout hatch            1 / exp(6.08487164651134 - log(x + 0.25823605907…</span></span></code></pre></div>
<p><code><a href="../reference/predict_phenology.html">predict_phenology()</a></code> will extract the expression from the
object and use it to predict phenology. We will demonstrate this in the
<a href="https://bmait101.github.io/hatchR/articles/Predict_phenology_basic.html">Predict
phenology: Basic</a> vignette.</p>
</div>
<div class="section level3">
<h3 id="fitting-models-for-other-fishes">Fitting models for other fishes<a class="anchor" aria-label="anchor" href="#fitting-models-for-other-fishes"></a>
</h3>
<p>We demonstrate how the <code><a href="../reference/fit_model.html">fit_model()</a></code> function may be used
to create custom parameterizations for species beyond the Salmonids in
the <code>model_table</code> included in the package. We include
parameterizations from three warm-water species to demonstrate the
<code><a href="../reference/fit_model.html">fit_model()</a></code> utility for fishes beyond the scope of the
original effective value approach. These parameterizations are for
commonly cultured sportfishes including Smallmouth Bass (<em>Micropterus
dolomieu</em>) <span class="citation">(Webster 1948)</span>, Channel
Catfish (<em>Ictalurus punctatus</em>) <span class="citation">(Small and
Bates 2001)</span> , and Lake Sturgeon (<em>Acipenser fulvescens</em>)
<span class="citation">(Smith and King 2005)</span>.</p>
<p>We demonstrate the utility of this approach by creating a random
thermal regime with an ascending thermograph with a mean temperature of
16 °C, parameterizing models for each species, and demonstrating days to
hatch and developmental period for each species with the random thermal
regime .</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###  make temp regime</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># create random temps and corresponding dates</span></span>
<span><span class="va">temps_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">16</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dates_sim</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-07-01"</span><span class="op">)</span>,</span>
<span>             to <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2000-07-31"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data_sim</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">temps_sim</span></span>
<span><span class="va">data_sim</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dates_sim</span></span>
<span></span>
<span><span class="co"># change names so they aren't the same as the vector objects</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data_sim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temp_sim"</span>, <span class="st">"date_sim"</span><span class="op">)</span></span></code></pre></div>
<p>Next we’ll parameterize our models for the three different fishes</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### smallmouth mod</span></span>
<span><span class="va">smallmouth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">smallmouth</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hours"</span>, <span class="st">"temp_F"</span><span class="op">)</span></span>
<span><span class="va">smallmouth</span><span class="op">$</span><span class="va">hours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">54</span>, <span class="fl">70</span>, <span class="fl">78</span>, <span class="fl">90</span>, <span class="fl">98</span>, <span class="fl">150</span>, <span class="fl">167</span>, <span class="fl">238</span>, <span class="fl">234</span><span class="op">)</span></span>
<span><span class="va">smallmouth</span><span class="op">$</span><span class="va">temp_F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77</span>, <span class="fl">75</span>, <span class="fl">71</span>, <span class="fl">70</span>, <span class="fl">67</span>, <span class="fl">65</span>, <span class="fl">60</span>, <span class="fl">59</span>, <span class="fl">55</span>, <span class="fl">55</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change °F to °C and hours to days</span></span>
<span><span class="va">smallmouth</span> <span class="op">&lt;-</span> <span class="va">smallmouth</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>days <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">hours</span><span class="op">/</span><span class="fl">24</span><span class="op">)</span>,</span>
<span>         temp_C <span class="op">=</span> <span class="op">(</span><span class="va">temp_F</span> <span class="op">-</span><span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span><span class="op">/</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># model object for smallmouth bass </span></span>
<span><span class="va">smb_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">smallmouth</span><span class="op">$</span><span class="va">temp_C</span>,</span>
<span>                     days <span class="op">=</span> <span class="va">smallmouth</span><span class="op">$</span><span class="va">days</span>,</span>
<span>                     species <span class="op">=</span> <span class="st">"smb"</span>,</span>
<span>                     development_type <span class="op">=</span> <span class="st">"hatch"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### catfish mod</span></span>
<span><span class="va">catfish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">catfish</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"days"</span>, <span class="st">"temp_C"</span><span class="op">)</span></span>
<span><span class="va">catfish</span><span class="op">$</span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">21</span>,<span class="fl">26</span><span class="op">)</span></span>
<span><span class="va">catfish</span><span class="op">$</span><span class="va">temp_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">22</span>,<span class="fl">10</span>,<span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cat_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="va">catfish</span><span class="op">$</span><span class="va">temp_C</span>,</span>
<span>                     days <span class="op">=</span> <span class="va">catfish</span><span class="op">$</span><span class="va">days</span>,</span>
<span>                     species <span class="op">=</span> <span class="st">"catfish"</span>,</span>
<span>                     development_type <span class="op">=</span> <span class="st">"hatch"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### lake sturgeon mod</span></span>
<span><span class="va">sturgeon</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sturgeon</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"days"</span>, <span class="st">"CTU"</span><span class="op">)</span></span>
<span><span class="va">sturgeon</span><span class="op">$</span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">5</span>,<span class="fl">11</span>,<span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">sturgeon</span><span class="op">$</span><span class="va">CTU</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58.1</span>, <span class="fl">62.2</span>, <span class="fl">61.1</span>, <span class="fl">57.5</span>, <span class="fl">58.1</span>, <span class="fl">71.4</span>, <span class="fl">54.7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sturgeon</span> <span class="op">&lt;-</span> <span class="va">sturgeon</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>temp_C <span class="op">=</span> <span class="va">CTU</span><span class="op">/</span><span class="va">days</span><span class="op">)</span> <span class="co"># change CTUs to average temp and add column</span></span>
<span></span>
<span><span class="va">sturgeon_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span>days <span class="op">=</span> <span class="va">sturgeon</span><span class="op">$</span><span class="va">days</span>,</span>
<span>                          temp <span class="op">=</span> <span class="va">sturgeon</span><span class="op">$</span><span class="va">temp_C</span>,</span>
<span>                          species <span class="op">=</span> <span class="st">"sturgeon"</span>,</span>
<span>                          development_type <span class="op">=</span> <span class="st">"hatch"</span><span class="op">)</span></span></code></pre></div>
<p>Note the <em>R<sup>2</sup></em> fit from the models below. You can
see they generally all preform well and are in line with values from
model 2 of <span class="citation">Beacham and Murray (1990)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#model fits</span></span>
<span><span class="va">smb_mod</span><span class="op">$</span><span class="va">r_squared</span>; <span class="va">cat_mod</span><span class="op">$</span><span class="va">r_squared</span>; <span class="va">sturgeon_mod</span><span class="op">$</span><span class="va">r_squared</span></span>
<span><span class="co">#&gt; [1] 0.9868067</span></span>
<span><span class="co">#&gt; [1] 0.9433598</span></span>
<span><span class="co">#&gt; [1] 0.9217358</span></span></code></pre></div>
<p>After we have our fits for each species we can predict phenology
using our <code>data_sim</code> datset we created above.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### predict_phenology</span></span>
<span></span>
<span><span class="co">#smallmouth bass</span></span>
<span><span class="va">smb_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sim</span>,</span>
<span>                  dates <span class="op">=</span> <span class="va">date_sim</span>,</span>
<span>                  temperature <span class="op">=</span> <span class="va">temp_sim</span>,</span>
<span>                  spawn.date <span class="op">=</span> <span class="st">"2000-07-01"</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">smb_mod</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># catfish</span></span>
<span><span class="va">catfish_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sim</span>,</span>
<span>                  dates <span class="op">=</span> <span class="va">date_sim</span>,</span>
<span>                  temperature <span class="op">=</span> <span class="va">temp_sim</span>,</span>
<span>                  spawn.date <span class="op">=</span> <span class="st">"2000-07-01"</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">cat_mod</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># sturgeon</span></span>
<span><span class="co"># note that 16 C is pretty far out of range of temps for model fit, not best practice</span></span>
<span><span class="va">sturgeon_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sim</span>,</span>
<span>                  dates <span class="op">=</span> <span class="va">date_sim</span>,</span>
<span>                  temperature <span class="op">=</span> <span class="va">temp_sim</span>,</span>
<span>                  spawn.date <span class="op">=</span> <span class="st">"2000-07-01"</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">sturgeon_mod</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span></code></pre></div>
<p>After we have our predictions we’ll combine our results and do a
little data cleaning.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary for all species</span></span>
<span><span class="va">all_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">all_res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"start"</span>, <span class="st">"stop"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_res</span><span class="op">$</span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">catfish_res</span><span class="op">$</span><span class="va">dev_period</span><span class="op">$</span><span class="va">start</span>, </span>
<span>                   <span class="va">smb_res</span><span class="op">$</span><span class="va">dev_period</span><span class="op">$</span><span class="va">start</span>, </span>
<span>                   <span class="va">sturgeon_res</span><span class="op">$</span><span class="va">dev_period</span><span class="op">$</span><span class="va">start</span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_res</span><span class="op">$</span><span class="va">stop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">catfish_res</span><span class="op">$</span><span class="va">dev_period</span><span class="op">$</span><span class="va">stop</span>,</span>
<span>                  <span class="va">smb_res</span><span class="op">$</span><span class="va">dev_period</span><span class="op">$</span><span class="va">stop</span>, </span>
<span>                  <span class="va">sturgeon_res</span><span class="op">$</span><span class="va">dev_period</span><span class="op">$</span><span class="va">stop</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">all_res</span> <span class="op">&lt;-</span> <span class="va">all_res</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>days <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">stop</span><span class="op">-</span><span class="va">start</span><span class="op">)</span>,</span>
<span>         index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>,<span class="fl">16.5</span>,<span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="co"># index for our horizontal bars</span></span>
<span></span>
<span><span class="va">all_res</span><span class="op">$</span><span class="va">Species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel Catfish"</span>, <span class="st">"Smallmouth Bass"</span>, <span class="st">"Lake Sturgeon"</span><span class="op">)</span></span></code></pre></div>
<p>And then finally we can plot our results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sim</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_sim</span>, y <span class="op">=</span> <span class="va">temp_sim</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sim</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_sim</span>, y <span class="op">=</span> <span class="va">temp_sim</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">start</span>, xmax <span class="op">=</span> <span class="va">stop</span>, ymax <span class="op">=</span><span class="va">index</span><span class="op">-</span><span class="fl">.35</span>, ymin <span class="op">=</span> <span class="va">index</span><span class="op">-</span><span class="fl">.5</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start</span> <span class="op">+</span> <span class="op">(</span><span class="va">stop</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.25</span>, y <span class="op">=</span> <span class="op">(</span><span class="va">index</span> <span class="op">-</span><span class="fl">0.425</span><span class="op">)</span>, label <span class="op">=</span> <span class="va">days</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Temperature (°C)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deepskyblue4"</span>, <span class="st">"grey23"</span>, <span class="st">"darkolivegreen4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Parameterize_models_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="important-considerations">Important considerations<a class="anchor" aria-label="anchor" href="#important-considerations"></a>
</h2>
<p>Here are some important considerations:</p>
<blockquote>
<p><em>Your model fits will only be as good as the data they are
generated from</em>.</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><p>We recommend a minimum of four temperature x hatch/emerge data
points.</p></li>
<li>
<p>Data should be spread across temperatures as much as
possible.</p>
<ul>
<li>It’s much better to have a fit derived from data for temperatures
such as 3, 7, 10, 14 °C than it is 8, 9, 10, 11 °C.</li>
<li>The behavior of the model function around the tails of very cold or
warm temperatures (relative to the fish species) drive the fit of the
function, so more extreme temperatures are helpful.</li>
</ul>
</li>
<li><p>Think hard about whether the data you are generating your
parameterization from match the data from which you are trying to
predict or if you are extrapolating beyond what is sensible for the
model.</p></li>
<li><p>Understand your response variable, most models are fit to 50%
hatch or emergence for a family group or population. However, your data
may be different and you should interpret your results accordingly
(e.g. comparisons between 50% hatch from population A to 95% hatch of
population B may not be reasonable).</p></li>
</ol>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-austin2019" class="csl-entry">
Austin, Catherine S., Timothy E. Essington, and Thomas P. Quinn. 2019.
<span>“Spawning and Emergence Phenology of Bull Trout (Salvelinus
Confluentus) Under Differing Thermal Regimes.”</span> <em>Journal of
Fish Biology</em> 94 (1): 191–95. <a href="https://doi.org/10.1111/jfb.13864" class="external-link">https://doi.org/10.1111/jfb.13864</a>.
</div>
<div id="ref-beacham1990" class="csl-entry">
Beacham, Terry D., and Clyde B. Murray. 1990. <span>“Temperature, Egg
Size, and Development of Embryos and Alevins of Five Species of Pacific
Salmon: A Comparative Analysis.”</span> <em>Transactions of the American
Fisheries Society</em> 119 (6): 927–45. <a href="https://doi.org/10.1577/1548-8659(1990)119&lt;0927:TESADO&gt;2.3.CO;2" class="external-link">https://doi.org/10.1577/1548-8659(1990)119&lt;0927:TESADO&gt;2.3.CO;2</a>.
</div>
<div id="ref-quinn2018" class="csl-entry">
Quinn, Thomas P. 2018. <em>The Behavior and Ecology of Pacific Salmon
and Trout</em>. University of Washington Press.
</div>
<div id="ref-small_effect_2001" class="csl-entry">
Small, Brian C., and Terry D. Bates. 2001. <span>“Effect of
<span>Low</span>-<span>Temperature</span> <span>Incubation</span> of
<span>Channel</span> <span>Catfish</span> <span>Ictalurus</span>
Punctatus <span>Eggs</span> on <span>Development</span>,
<span>Survival</span>, and <span>Growth</span>.”</span> <em>Journal of
the World Aquaculture Society</em> 32 (2): 189–94. <a href="https://doi.org/10.1111/j.1749-7345.2001.tb01094.x" class="external-link">https://doi.org/10.1111/j.1749-7345.2001.tb01094.x</a>.
</div>
<div id="ref-smith_dynamics_2005" class="csl-entry">
Smith, K. M., and D. K. King. 2005. <span>“Dynamics and Extent of Larval
Lake Sturgeon <span>Acipenser</span> Fulvescens Drift in the
<span>Upper</span> <span>Black</span> <span>River</span>,
<span>Michigan</span>.”</span> <em>Journal of Applied Ichthyology</em>
21 (3): 161–68. <a href="https://doi.org/10.1111/j.1439-0426.2005.00623.x" class="external-link">https://doi.org/10.1111/j.1439-0426.2005.00623.x</a>.
</div>
<div id="ref-sparks2019" class="csl-entry">
Sparks, Morgan M., Jeffrey A. Falke, Thomas P. Quinn, Milo D. Adkison,
Daniel E. Schindler, Krista Bartz, Dan Young, and Peter A. H. Westley.
2019. <span>“Influences of Spawning Timing, Water Temperature, and
Climatic Warming on Early Life History Phenology in Western Alaska
Sockeye Salmon.”</span> <em>Canadian Journal of Fisheries and Aquatic
Sciences</em> 76 (1): 123–35. <a href="https://doi.org/10.1139/cjfas-2017-0468" class="external-link">https://doi.org/10.1139/cjfas-2017-0468</a>.
</div>
<div id="ref-velsen1987" class="csl-entry">
Velsen, FPJ. 1987. <span>“Temperature and Incubation in Pacific Salmon
and Rainbow Trout: Compilation of Data on Median Hatching Time,
Mortality and Embryonic Staging.”</span> Department of Fisheries;
Oceans, Fisheries Research Branch, Pacific ….
</div>
<div id="ref-webster_relation_1948" class="csl-entry">
Webster, Dwight A. 1948. <span>“Relation of <span>Temperature</span> to
<span>Survival</span> and <span>Incubation</span> of the
<span>Eggs</span> of <span>Smallmouth</span> <span>Bass</span>
(<span>Micropterus</span> <span>Dolomieu</span>).”</span>
<em>Transactions of the American Fisheries Society</em> 75 (1): 43–47.
<a href="https://doi.org/10.1577/1548-8659(1945)75%5B43:ROTTSA%5D2.0.CO;2" class="external-link">https://doi.org/10.1577/1548-8659(1945)75[43:ROTTSA]2.0.CO;2</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bryan M. Maitland, Morgan M. Sparks.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
