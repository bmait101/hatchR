<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Predict fish phenology: advanced • hatchR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict fish phenology: advanced">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hatchR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Adavanced_plotting.html">Adavanced plotting</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Parameterize_models.html">Parameterize hatchR Models</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_advanced.html">Predict fish phenology: advanced</a></li>
    <li><a class="dropdown-item" href="../articles/Predict_phenology_basic.html">Predict fish phenology: basic</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bmait101/hatchR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Predict fish phenology: advanced</h1>
                        <h4 data-toc-skip class="author">Morgan Sparks,
Bryan M. Maitland</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bmait101/hatchR/blob/master/vignettes/Predict_phenology_advanced.Rmd" class="external-link"><code>vignettes/Predict_phenology_advanced.Rmd</code></a></small>
      <div class="d-none name"><code>Predict_phenology_advanced.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>The function predict_phenolgy() is purposefully kept fairly simple so
it can be expanded to automate across datasets. Typically, this will
take the form of loops or vectorizing in R (functions of the map() and
apply() families). There are many reasons why you might want to automate
your ability to predict including predicting over multiple years,
multiple sites, predicting hatch or emergence, or even using multiple
potential spawn dates. We’ll show some examples below (moving from less
to more complicated). First, we load packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bmait101.github.io/hatchR/">hatchR</a></span><span class="op">)</span> <span class="co"># for data and phenology modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># for additional plotting options</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span> <span class="co"># for vectorizing</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span> <span class="co"># for data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># for data manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span>  <span class="co"># for date manipulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>  <span class="co"># for data manipulation</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-spawn-dates">Multiple spawn dates<a class="anchor" aria-label="anchor" href="#multiple-spawn-dates"></a>
</h3>
<p>Given the example we used in the Predict Phenology-Basic vignette,
perhaps we now want to expand it to predict multiple spawn dates (e.g.,
the early, peak, and late part of the spawning distribution) for the
Woody Island population in Lake Iliamna. Using Table 1 from <span class="citation">Sparks et al. (2019)</span> we see that the spawning
range is between August 14 and September 3rd, with the peak occurring
August 18th. We can set these dates up as a vector to run the model
over.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WI_spawn_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1990-08-14"</span>, <span class="st">"1990-08-18"</span>, <span class="st">"1990-09-3"</span><span class="op">)</span></span></code></pre></div>
<p>The we will go through the typical process of getting the model
parameterized as we did previously.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sockeye_hatch_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>  author <span class="op">=</span> <span class="st">"Beacham and Murray 1990"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"sockeye"</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  dev.type <span class="op">=</span> <span class="st">"hatch"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we can automate the model. We’ll demonstrate two ways—a loop and
a vectorized approach.</p>
<div class="section level4">
<h4 id="looping">Looping<a class="anchor" aria-label="anchor" href="#looping"></a>
</h4>
<p>We will show an example of how to set up a <code>for</code> loop to
run through each element of the <code>woody_island</code> dataset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Loop storage objects</span></span>
<span><span class="va">OUT_loop_all</span> <span class="op">&lt;-</span> <span class="cn">NULL</span> <span class="co"># empty object to store output in</span></span>
<span><span class="va">OUT_loop_d2h</span> <span class="op">&lt;-</span> <span class="cn">NULL</span> <span class="co"># empty object for days to hatch ( if we just wanted to output these data)</span></span>
<span></span>
<span><span class="co">### Loop body</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">WI_spawn_dates</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># d will be our numerical iterator</span></span>
<span></span>
<span>  <span class="va">WI_spawn</span> <span class="op">&lt;-</span> <span class="va">WI_spawn_dates</span><span class="op">[</span><span class="va">d</span><span class="op">]</span> <span class="co"># subset the element d of the vector and assign to object</span></span>
<span></span>
<span>  <span class="co"># predict phenology</span></span>
<span>  <span class="va">WI_hatch</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">woody_island</span>,</span>
<span>    dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>    temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>    spawn.date <span class="op">=</span> <span class="va">WI_spawn</span>,</span>
<span>    model <span class="op">=</span> <span class="va">sockeye_hatch_mod</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co">### ALL output ###</span></span>
<span></span>
<span>  <span class="co"># do this if we want to maintain all info predict_phenology</span></span>
<span>  <span class="va">OUT_loop_all</span><span class="op">[[</span><span class="va">d</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">WI_hatch</span> <span class="co"># store list into the dth list element of the OUT_loop object</span></span>
<span></span>
<span>  <span class="co">### A single element of output ###</span></span>
<span></span>
<span>  <span class="co"># alternatively, if you know you just want something like days to hatch you can access</span></span>
<span>  <span class="co"># that part of the list and just store it as object</span></span>
<span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NA</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># empty dataframe to add in data</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spawn_date"</span>, <span class="st">"days_2_hatch"</span><span class="op">)</span> <span class="co"># change column names</span></span>
<span></span>
<span>  <span class="va">temp</span><span class="op">$</span><span class="va">spawn_date</span> <span class="op">&lt;-</span> <span class="va">WI_spawn</span> <span class="co"># assign spawn date</span></span>
<span>  <span class="va">temp</span><span class="op">$</span><span class="va">days_2_hatch</span> <span class="op">&lt;-</span> <span class="va">WI_hatch</span><span class="op">$</span><span class="va">days2done</span> <span class="co"># assign days to hathc</span></span>
<span></span>
<span>  <span class="va">OUT_loop_d2h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">OUT_loop_d2h</span>, <span class="va">temp</span><span class="op">)</span> <span class="co"># row bind temp object and OUT object</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">### Loop output (note: we iteratively add to the NULL objects we make at the beginning)</span></span>
<span></span>
<span><span class="co"># you can see OUT_loop is a list of lists with three lists each with four elements</span></span>
<span><span class="co"># (i.e., the four outputs of predict_phenology())</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">OUT_loop_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 71</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-14"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-23"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:71] 0.0213 0.0196 0.0165 0.0139 0.0147 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [71 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 74</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-18"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-30"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:74] 0.0147 0.0155 0.0157 0.0166 0.0169 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [74 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 110</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-09-03"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-12-21"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:110] 0.0163 0.0165 0.0165 0.0165 0.0165 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [110 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="co"># you can also see we made a tibble of dates and predicted days to hatch</span></span>
<span><span class="va">OUT_loop_d2h</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   spawn_date days_2_hatch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1990-08-14           71</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1990-08-18           74</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1990-09-3           110</span></span></code></pre></div>
<p>If you don’t want the full output of each run of
<code>predict_phenolgy()</code> and you just for example want the
predicted days to hatch, then it’s easier to access those elements
within the loop as demonstrated with the <code>temp</code> object
section demonstrated in the loop.</p>
</div>
<div class="section level4">
<h4 id="vectorizing">Vectorizing<a class="anchor" aria-label="anchor" href="#vectorizing"></a>
</h4>
<p><strong>Mapping:</strong></p>
<p>Vectorizing, while historically about prioritizing speed, is now more
about making your code more readable (see sections in <a href="https://r4ds.had.co.nz/iteration.html#for-loops-vs.-functionals" class="external-link">r4ds</a>
and <a href="https://adv-r.hadley.nz/functionals.html" class="external-link">Advanced R</a>).
We’ll demonstrate using <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> from the <code>purrr</code>
package. If you are unfamiliar with mapping but want to learn more about
how it works and it’s power, we highly recommend the linked chapters
from R for Data Science (<span class="citation">Grolemund and Garrett
(n.d.)</span>) and Advanced R (<span class="citation"><span>“9
Functionals | Advanced r”</span> (n.d.)</span>) shown above.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># map works by applying a function over a list (our vector is a very simple list)</span></span>
<span><span class="co"># if you are familiar with apply() functions, map is essentially the same</span></span>
<span></span>
<span><span class="va">results_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="va">WI_spawn_dates</span>, <span class="co"># vector we are mapping over</span></span>
<span>  <span class="va">predict_phenology</span>, <span class="co"># function we are mapping with (note no "()"),</span></span>
<span>  data <span class="op">=</span> <span class="va">woody_island</span>, <span class="co"># additional arguments required by predict_phenology</span></span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>  model <span class="op">=</span> <span class="va">sockeye_hatch_mod</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we now have a list of lists the same as OUT_loop</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">results_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 71</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-14"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-23"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:71] 0.0213 0.0196 0.0165 0.0139 0.0147 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [71 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 74</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-18"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-30"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:74] 0.0147 0.0155 0.0157 0.0166 0.0169 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [74 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 110</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-09-03"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-12-21"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:110] 0.0163 0.0165 0.0165 0.0165 0.0165 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [110 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="co"># we can then access days to hatch easily as such</span></span>
<span><span class="va">results_map</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="st">"days2done"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  71  74 110</span></span></code></pre></div>
<p><strong>Apply:</strong></p>
<p>While tidyverse and associated packages have become quite popular in
the world of R, the base functionality of R has long had a set of
functions to do similar things as map. They are called the apply family.
Because <code>hatchR</code> is built using much of the functionality of
the tidyverse we opt for using <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> over apply functions,
however we will demonstrate a similar workflow as above using the apply
family.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lapply() is the equivalent function as map() in the apply family</span></span>
<span><span class="co"># they both output lists</span></span>
<span></span>
<span><span class="va">results_lapply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">WI_spawn_dates</span>, <span class="co"># vector we are mapping over</span></span>
<span>  <span class="va">predict_phenology</span>, <span class="co"># function we are mapping with (note no "()"),</span></span>
<span>  data <span class="op">=</span> <span class="va">woody_island</span>, <span class="co"># additional arguments required by predict phenology</span></span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>  model <span class="op">=</span> <span class="va">sockeye_hatch_mod</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># you can see that lapply and map output the same results</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">results_lapply</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 71</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-14"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-23"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:71] 0.0213 0.0196 0.0165 0.0139 0.0147 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [71 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 74</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-18"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-30"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:74] 0.0147 0.0155 0.0157 0.0166 0.0169 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [74 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 110</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-09-03"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-12-21"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:110] 0.0163 0.0165 0.0165 0.0165 0.0165 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [110 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt;</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="iterating-over-multiple-variables">Iterating over multiple variables<a class="anchor" aria-label="anchor" href="#iterating-over-multiple-variables"></a>
</h3>
<p>An obvious extension of the example above is to use sites with
multiple years of data and to predict hatch and emergence. In the
example from the Predict Phenology-Basic vignette, we saw we had some
days where the logger appeared to be out of the water, so let’s use a
cleaner dataset.</p>
<p>In this example we will use temperature from the Crooked River, a
tributary of the Boise River in Idaho, USA, from a reach with known bull
trout spawning. The dataset is included as
<code>crooked_river</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># look at data structure</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">crooked_river</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 3,367</span></span>
<span><span class="co">#&gt; Columns: 2</span></span>
<span><span class="co">#&gt; $ date   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span> 2011-09-09, 2011-09-10, 2011-09-11, 2011-09-12, 2011-09-13, 20…</span></span>
<span><span class="co">#&gt; $ temp_c <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 7.57, 7.39, 7.19, 7.24, 7.59, 7.68, 7.51, 7.41, 6.19, 6.65, 6.7…</span></span>
<span></span>
<span><span class="co"># visually check data</span></span>
<span><span class="fu"><a href="../reference/plot_check_temp.html">plot_check_temp</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">crooked_river</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>  temp_min <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  temp_max <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Predict_phenology_advanced_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># we can use some functions from tidyverse to do a datacheck</span></span>
<span><span class="co"># this shows the number of observations per year</span></span>
<span><span class="va">crooked_river</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># add a column converting the date to year</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># count observations/year</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;    year     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>010    31</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>011   479</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>012   731</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>013   729</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">2</span>014   730</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">2</span>015   667</span></span></code></pre></div>
<p>We see we have 5 full years of data to use. For the sake of this
exercise, let’s assume bull trout spawning in this system starts
September 1st, peaks September 15th, and is mostly done by September
30th.</p>
<p>Remember, our data starts just barely in 2010, so our spawning years
would be 2011-2015. However we may not have enough days of record to
make predictions for 2015 so best to check that first.</p>
<p>First let’s just check to see if fish spawning in 2015 would have
enough data to hatch and emerge.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### set up our bull trout hatch and emergence models</span></span>
<span><span class="va">bull_hatch_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>  author <span class="op">=</span> <span class="st">"Austin et al. 2017"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"bull trout"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"MM"</span>,</span>
<span>  dev.type <span class="op">=</span> <span class="st">"hatch"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bull_emerge_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>  author <span class="op">=</span> <span class="st">"Austin et al. 2017"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"bull trout"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"MM"</span>,</span>
<span>  dev.type <span class="op">=</span> <span class="st">"emerge"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># models are different</span></span>
<span><span class="va">bull_hatch_mod</span></span>
<span><span class="co">#&gt; expression(1/exp(5.086 - (x * 0.131)))</span></span>
<span><span class="va">bull_emerge_mod</span></span>
<span><span class="co">#&gt; expression(1/exp(5.59 - (x * 0.126)))</span></span>
<span></span>
<span><span class="co">### check 2015 dates</span></span>
<span></span>
<span><span class="va">dates_2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2015-09-01"</span>, <span class="st">"2015-09-15"</span>, <span class="st">"2015-09-30"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## hatch first</span></span>
<span><span class="va">hatch_2015</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">dates_2015</span>,</span>
<span>  <span class="va">predict_phenology</span>,</span>
<span>  data <span class="op">=</span> <span class="va">crooked_river</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>  model <span class="op">=</span> <span class="va">bull_hatch_mod</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">hatch_2015</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="st">"days2done"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 66 70 83</span></span></code></pre></div>
<p>See how we receive a warning “Fish did not develop, did not accrue
enough effective units. Spawn date =2015-09-15. Did your fish spawn too
close to the end of your data?” It tells us the spawn date we used so we
can reference which date isn’t working if we use an string of multiple
dates to predict over.</p>
<p>If fish aren’t hatching they definitely are not going to emerge, so
we won’t use 2015.</p>
<div class="section level4">
<h4 id="looping-1">Looping<a class="anchor" aria-label="anchor" href="#looping-1"></a>
</h4>
<p>We will build a nested loop to automate over model selection
variables and then over the dates. So the order of applying the
<code><a href="../reference/predict_phenology.html">predict_phenology()</a></code> function in the loop example below is
as follows:</p>
<ul>
<li>
<p>Predict hatch</p>
<ol style="list-style-type: decimal">
<li><p>2011 spawn dates</p></li>
<li><p>…</p></li>
<li><p>2014 spawn dates</p></li>
</ol>
</li>
<li>
<p>Predict emergence</p>
<ol style="list-style-type: decimal">
<li><p>2011 spawn dates</p></li>
<li><p>…</p></li>
<li><p>2014 spawn dates</p></li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## mini loop to make vector of dates</span></span>
<span><span class="va">spawn_dates</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">year</span> <span class="kw">in</span> <span class="fl">2011</span><span class="op">:</span><span class="fl">2014</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-09-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-09-15"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-09-30"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">spawn_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">spawn_dates</span>, <span class="va">temp_dates</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">spawn_dates</span></span>
<span><span class="co">#&gt;  [1] "2011-09-01" "2011-09-15" "2011-09-30" "2012-09-01" "2012-09-15"</span></span>
<span><span class="co">#&gt;  [6] "2012-09-30" "2013-09-01" "2013-09-15" "2013-09-30" "2014-09-01"</span></span>
<span><span class="co">#&gt; [11] "2014-09-15" "2014-09-30"</span></span>
<span></span>
<span><span class="co">### loop for prediction</span></span>
<span><span class="va">OUT</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># build a counter for adding to our list of lists (OUT)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">mod</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hatch"</span>, <span class="st">"emerge"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># loop for hatch and emerge</span></span>
<span></span>
<span>  <span class="co"># here we just iterate model selection over the two hatch and emerge options</span></span>
<span>  <span class="co"># in the first for loop</span></span>
<span>  <span class="va">dev_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_select.html">model_select</a></span><span class="op">(</span></span>
<span>    author <span class="op">=</span> <span class="st">"Austin et al. 2017"</span>,</span>
<span>    species <span class="op">=</span> <span class="st">"bull trout"</span>,</span>
<span>    model <span class="op">=</span> <span class="st">"MM"</span>,</span>
<span>    dev.type <span class="op">=</span> <span class="va">mod</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">d</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">spawn_dates</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># nested loop over spawn dates</span></span>
<span></span>
<span>    <span class="co"># here we iterate over every date of spawn_dates but run this loop twice,</span></span>
<span>    <span class="co"># once for each value of the first for loop</span></span>
<span></span>
<span>    <span class="va">spawn</span> <span class="op">&lt;-</span> <span class="va">spawn_dates</span><span class="op">[</span><span class="va">d</span><span class="op">]</span> <span class="co"># get spawn date</span></span>
<span></span>
<span>    <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_phenology.html">predict_phenology</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">crooked_river</span>,</span>
<span>      dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>      temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>      spawn.date <span class="op">=</span> <span class="va">spawn</span>,</span>
<span>      model <span class="op">=</span> <span class="va">dev_mod</span></span>
<span>    <span class="op">)</span> <span class="co"># notice we are calling the mod we set in the fist loop</span></span>
<span></span>
<span>    <span class="va">OUT</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">temp</span></span>
<span></span>
<span>    <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span> <span class="co"># add to your counter</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># look at results</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">OUT</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 24</span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 68</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2011-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2011-10-08"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:68] 0.0148 0.0144 0.0144 0.0148 0.0152 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [68 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 76</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2011-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2011-10-22"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:76] 0.0165 0.0165 0.0163 0.0163 0.0139 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [76 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 102</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2011-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2011-11-19"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:102] 0.0152 0.0152 0.0158 0.0158 0.0153 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [102 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 68</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2012-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2012-10-05"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:68] 0.0183 0.0183 0.0158 0.0158 0.0156 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [68 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 83</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2012-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2012-10-26"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:83] 0.015 0.015 0.0153 0.0153 0.0146 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [83 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 103</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2012-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2012-11-20"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:103] 0.0143 0.0143 0.0139 0.0139 0.0136 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [103 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 59</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2013-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2013-09-30"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:59] 0.0203 0.0203 0.0212 0.0212 0.021 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [59 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 84</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2013-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2013-10-26"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:84] 0.0202 0.0202 0.02 0.02 0.0182 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [84 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 108</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2013-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2013-11-22"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:108] 0.013 0.013 0.0119 0.0119 0.0115 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [108 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 66</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2014-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-10-03"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:66] 0.0153 0.0153 0.0155 0.0155 0.015 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [66 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 71</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2014-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-10-20"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:71] 0.0149 0.0149 0.017 0.017 0.017 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [71 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 93</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2014-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-11-15"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:93] 0.0142 0.0142 0.0123 0.0123 0.012 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [93 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 143</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2011-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2011-11-15"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:143] 0.00863 0.00842 0.00843 0.00864 0.00889 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [143 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 165</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2011-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2011-12-06"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:165] 0.00962 0.00962 0.0095 0.0095 0.00815 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [165 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 199</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2011-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2012-01-07"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:199] 0.00889 0.00889 0.00921 0.00921 0.00894 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [199 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 139</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2012-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2012-11-09"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:139] 0.0106 0.0106 0.00918 0.00918 0.00909 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [139 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 166</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2012-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2012-12-07"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:166] 0.00878 0.00878 0.00892 0.00892 0.00855 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [166 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 197</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2012-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2013-01-06"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:197] 0.00836 0.00836 0.00817 0.00817 0.00796 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [197 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 130</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2013-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2013-11-05"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:130] 0.0117 0.0117 0.0122 0.0122 0.0121 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [130 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 172</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2013-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2013-12-09"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:172] 0.0117 0.0117 0.0116 0.0116 0.0105 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [172 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 205</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2013-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-01-10"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:205] 0.00766 0.00766 0.00704 0.00704 0.0068 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [205 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 128</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2014-09-01"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-11-03"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:128] 0.00892 0.00892 0.00906 0.00906 0.00874 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [128 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 149</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2014-09-15"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-11-28"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:149] 0.00869 0.00869 0.00987 0.00987 0.0099 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [149 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 184</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: POSIXct[1:1], format: "2014-09-30"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : POSIXct[1:1], format: "2014-12-30"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:184] 0.00829 0.00829 0.00721 0.00721 0.00706 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [184 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt;</span></span></code></pre></div>
<p>The output of this loop is again a list of lists. This time 24 lists
that comprise the elements of each <code><a href="../reference/predict_phenology.html">predict_phenology()</a></code>
iteration. Simply, the loop selects the hatch model, runs it for every
date in our vector (<code>spawn_dates</code>) and then switches over to
an emerge model and does the same thing. The point of having an iterator
(<code>i</code>) is that we can make a new list addition to OUT for
every combination of the <code>dev_mod</code> (hatch and emerge) and the
12 dates we want to run—resulting in 24 total individual lists that are
appended to our OUT list of lists as we walk through each iteration of
the for loop.</p>
<p>If that sounds a bit complicated, it’s because it is. And this is
where the vectorized approaches really shine.</p>
<p>A quick note about accessing lists. Even if you want to write loops
instead of vectorizing, we do recommend accessing those results via a
vectorized approach. It’s hard to pull out a lot of information from
from very large nested loops. You would probably write a custom loop to
do so. However, those results are easily accessed by map, like so:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapped_results</span> <span class="op">&lt;-</span> <span class="va">OUT</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="st">"ef.tibble"</span><span class="op">)</span></span></code></pre></div>
<p>The above code outputs the <code>ef.tibble</code> element from every
one of your lists from each combination of spawn date and phenology type
into a dataframe like object which can then easily be plotted. Notice,
we now use <code><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df()</a></code> because we know the list element we are
accessing is in the format of a dataframe type object (a tibble).</p>
</div>
<div class="section level4">
<h4 id="vectorizing-1">Vectorizing<a class="anchor" aria-label="anchor" href="#vectorizing-1"></a>
</h4>
<p>We’ll use the purrr function <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap()</a></code> to vectorize our
multiple-input map function. Let’s again set up our iterative variables.
We’ll do the same workflow as the past example but now exclusively with
mapping.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># slightly cleaner spawn dates with map output is a list of vectors</span></span>
<span><span class="va">spawn_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2011</span><span class="op">:</span><span class="fl">2014</span><span class="op">)</span>, <span class="co"># year vector to map for custom function</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">{</span> <span class="co"># custom paste function</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-09-01"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-09-15"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-09-30"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># pipe to unlist() to make a vector</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dev_mods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hatch"</span>, <span class="st">"emerge"</span><span class="op">)</span>,</span>
<span>  <span class="va">model_select</span>,</span>
<span>  author <span class="op">=</span> <span class="st">"Austin et al. 2017"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"bull trout"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"MM"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we then set up a variable grid for all combinations of our models and dates</span></span>
<span><span class="co"># it is very important to make the names of the columns in var_grid to match the</span></span>
<span><span class="co"># arguments of the predict_phenology function (e.i., model = and spawn.date =)</span></span>
<span></span>
<span><span class="va">var_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">dev_mods</span>, spawn.date <span class="op">=</span> <span class="va">spawn_dates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">var_grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   model        spawn.date</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">&lt;expression&gt;</span> 2011-09-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">&lt;expression&gt;</span> 2011-09-15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">&lt;expression&gt;</span> 2011-09-30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #949494;">&lt;expression&gt;</span> 2012-09-01</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #949494;">&lt;expression&gt;</span> 2012-09-15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="color: #949494;">&lt;expression&gt;</span> 2012-09-30</span></span>
<span></span>
<span><span class="co">### mutliple input mapping</span></span>
<span></span>
<span><span class="va">crooked_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span><span class="va">var_grid</span>, <span class="co"># combos of variables to iterate over</span></span>
<span>  <span class="va">predict_phenology</span>, <span class="co"># function</span></span>
<span>  data <span class="op">=</span> <span class="va">crooked_river</span>, <span class="co"># additional arguments required by function</span></span>
<span>  dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>  temperature <span class="op">=</span> <span class="va">temp_c</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now that we’ve demonstrated both loops and mapping to get at
iterating over multiple variables, let’s verify our results match.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loop predictions</span></span>
<span><span class="va">preds_loop</span> <span class="op">&lt;-</span> <span class="va">OUT</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="st">"days2done"</span><span class="op">)</span></span>
<span><span class="va">preds_pmap</span> <span class="op">&lt;-</span> <span class="va">crooked_predictions</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="st">"days2done"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># everything matches!</span></span>
<span><span class="va">preds_loop</span> <span class="op">==</span> <span class="va">preds_pmap</span></span>
<span><span class="co">#&gt;  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span></span>
<span><span class="co">#&gt; [16] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="getting-usable-output">Getting usable output<a class="anchor" aria-label="anchor" href="#getting-usable-output"></a>
</h4>
<p>Because the basic output of these iterative processes are big lists
of lists, it can be a little annoying to access all that data. However,
this is again were the different flavors of map can be our friend. We’ve
already shown examples of how to access the predictions, but
<code><a href="../reference/predict_phenology.html">predict_phenology()</a></code> outputs much more data than just point
estimates.</p>
<p>First we’ll demonstrate an example of how we can take those
prediction and use them to create an object that’s useful for
plotting.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get predictions</span></span>
<span><span class="va">days</span> <span class="op">&lt;-</span> <span class="va">crooked_predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="st">"days2done"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make a vector of what type of phenology we were predicting</span></span>
<span><span class="co"># remember we ran hatch over 15 spawn dates then emerge over thos same 15</span></span>
<span><span class="va">phenology</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"hatch"</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"emerge"</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># make a vector of our spawn dates replicated twice and turn into a timepoint</span></span>
<span><span class="va">spawning</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">spawn_dates</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span> <span class="co"># we do this because the crooked_river dataset is ymd_hms</span></span>
<span></span>
<span><span class="co"># put them all together in an object</span></span>
<span><span class="va">bull_trout_phenology</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="va">phenology</span>, <span class="va">spawning</span>, <span class="va">days</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bull_trout_phenology</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   phenology spawning             days</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> hatch     2011-09-01 <span style="color: #949494;">00:00:00</span>    68</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> hatch     2011-09-15 <span style="color: #949494;">00:00:00</span>    76</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> hatch     2011-09-30 <span style="color: #949494;">00:00:00</span>   102</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> hatch     2012-09-01 <span style="color: #949494;">00:00:00</span>    68</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> hatch     2012-09-15 <span style="color: #949494;">00:00:00</span>    83</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> hatch     2012-09-30 <span style="color: #949494;">00:00:00</span>   103</span></span></code></pre></div>
<p>We could then make a plot with our original data:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter crooked_river to correct size</span></span>
<span><span class="va">crooked_river_11_15</span> <span class="op">&lt;-</span> <span class="va">crooked_river</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2015-06-01 00:00:00"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">crooked_river_11_15</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">temp_c</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">bull_trout_phenology</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spawning</span>, y <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkblue"</span>, shape <span class="op">=</span> <span class="fl">25</span>, size <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">bull_trout_phenology</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phenology</span> <span class="op">==</span> <span class="st">"hatch"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spawning</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkgreen"</span>, shape <span class="op">=</span> <span class="fl">24</span>, size <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">bull_trout_phenology</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">phenology</span> <span class="op">==</span> <span class="st">"emerge"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">spawning</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkorange"</span>, shape <span class="op">=</span> <span class="fl">24</span>, size <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Crooked River Bull Trout Developmental Phenology"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Blue = Spawn, Green = Hatch, Orange = Emerge"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Temperature"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Predict_phenology_advanced_files/figure-html/unnamed-chunk-15-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Not the best looking plot, but a good example of how to translate
output to a visual representation. For better looking plots, please see
the <strong>Plotting your data</strong> vignette.</p>
<p>Other data types you might want might include the tibble with dates,
temperature, and values and cumulative sums of effective values or the,
alternatively, the developmental period.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the tibble with all temperature and effective values for each phenological period</span></span>
<span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="va">crooked_predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="st">"ef.tibble"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">all_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   dates               temperature ef_vals ef_cumsum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2011-09-01 <span style="color: #949494;">00:00:00</span>        6.65  0.014<span style="text-decoration: underline;">8</span>    0.014<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2011-09-02 <span style="color: #949494;">00:00:00</span>        6.45  0.014<span style="text-decoration: underline;">4</span>    0.029<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2011-09-03 <span style="color: #949494;">00:00:00</span>        6.46  0.014<span style="text-decoration: underline;">4</span>    0.043<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2011-09-04 <span style="color: #949494;">00:00:00</span>        6.66  0.014<span style="text-decoration: underline;">8</span>    0.058<span style="text-decoration: underline;">4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2011-09-05 <span style="color: #949494;">00:00:00</span>        6.88  0.015<span style="text-decoration: underline;">2</span>    0.073<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2011-09-06 <span style="color: #949494;">00:00:00</span>        7.18  0.015<span style="text-decoration: underline;">8</span>    0.089<span style="text-decoration: underline;">4</span></span></span>
<span></span>
<span><span class="co"># the phenological durations for each prediction set</span></span>
<span><span class="va">development_period</span> <span class="op">&lt;-</span> <span class="va">crooked_predictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="st">"dev.period"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">development_period</span><span class="op">)</span></span>
<span><span class="co">#&gt;        start       stop</span></span>
<span><span class="co">#&gt; 1 2011-09-01 2011-10-08</span></span>
<span><span class="co">#&gt; 2 2011-09-15 2011-10-22</span></span>
<span><span class="co">#&gt; 3 2011-09-30 2011-11-19</span></span>
<span><span class="co">#&gt; 4 2012-09-01 2012-10-05</span></span>
<span><span class="co">#&gt; 5 2012-09-15 2012-10-26</span></span>
<span><span class="co">#&gt; 6 2012-09-30 2012-11-20</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="naming-your-lists">Naming your lists<a class="anchor" aria-label="anchor" href="#naming-your-lists"></a>
</h4>
<p>A problem with this approach is that you end up with very large lists
of lists without labels which require you to remember the data structure
you feed to your mapping function. However, purrr does have a method to
get around this which is the <code><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names()</a></code> function which you
would pipe into your mapping function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to use the simple Iliamna Lake example within a single season</span></span>
<span></span>
<span><span class="va">WI_named_list</span> <span class="op">&lt;-</span> <span class="va">WI_spawn_dates</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">predict_phenology</span>, <span class="co"># note we leave out the input row (WI_spawn_dates) because we are piping it in as input</span></span>
<span>    data <span class="op">=</span> <span class="va">woody_island</span>, <span class="co"># additional arguments required by predict phenology</span></span>
<span>    dates <span class="op">=</span> <span class="va">date</span>,</span>
<span>    temperature <span class="op">=</span> <span class="va">temp_c</span>,</span>
<span>    model <span class="op">=</span> <span class="va">sockeye_hatch_mod</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># you can now see each list is named according to its respective spawn date</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">WI_named_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ 1990-08-14:List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 71</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-14"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-23"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:71] 0.0213 0.0196 0.0165 0.0139 0.0147 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [71 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ 1990-08-18:List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 74</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-08-18"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-10-30"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:74] 0.0147 0.0155 0.0157 0.0166 0.0169 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [74 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt; </span></span>
<span><span class="co">#&gt;  $ 1990-09-3 :List of 4</span></span>
<span><span class="co">#&gt;   ..$ days2done : int 110</span></span>
<span><span class="co">#&gt;   ..$ dev.period:'data.frame':   1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ start: Date[1:1], format: "1990-09-03"</span></span>
<span><span class="co">#&gt;   .. ..$ stop : Date[1:1], format: "1990-12-21"</span></span>
<span><span class="co">#&gt;   ..$ ef.vals   : num [1:110] 0.0163 0.0165 0.0165 0.0165 0.0165 ...</span></span>
<span><span class="co">#&gt;   ..$ ef.tibble : spc_tbl_ [110 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "spec")=List of 3</span></span>
<span><span class="co">#&gt;   .. .. ..- attr(*, "class")= chr "col_spec"</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "problems")=&lt;externalptr&gt;</span></span>
<span></span>
<span><span class="co"># therefore a single elemet could be accessed with its name and the $ operator</span></span>
<span><span class="co"># if we wanted the dev.period for fish spawning on August 18th we would do the following</span></span>
<span></span>
<span><span class="va">WI_named_list</span><span class="op">$</span><span class="va">`1990-08-18`</span><span class="op">$</span><span class="va">dev.period</span></span>
<span><span class="co">#&gt;        start       stop</span></span>
<span><span class="co">#&gt; 1 1990-08-18 1990-10-30</span></span></code></pre></div>
<p>This approach works well for the example above, but not so well with
our examples with <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap()</a></code> because the variable grid we
create has a bunch of expressions which don’t work for naming lists.
However, if we were to do a <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap()</a></code> example where it was a
site x dates combination, that still work and would name the lists
according to their site and then the date used to predict phenology
(e.g. <code>named_list$site1$`date`$dev.period</code>)</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-9functi" class="csl-entry">
<span>“9 Functionals | Advanced r.”</span> n.d. <a href="https://adv-r.hadley.nz/functionals.html" class="external-link">https://adv-r.hadley.nz/functionals.html</a>.
</div>
<div id="ref-grolemund" class="csl-entry">
Grolemund, Hadley Wickham, and Garrett. n.d. <em>21 Iteration | R for
Data Science</em>. <a href="https://r4ds.had.co.nz/iteration.html" class="external-link">https://r4ds.had.co.nz/iteration.html</a>.
</div>
<div id="ref-sparks2019" class="csl-entry">
Sparks, Morgan M., Jeffrey A. Falke, Thomas P. Quinn, Milo D. Adkison,
Daniel E. Schindler, Krista Bartz, Dan Young, and Peter A. H. Westley.
2019. <span>“Influences of Spawning Timing, Water Temperature, and
Climatic Warming on Early Life History Phenology in Western Alaska
Sockeye Salmon.”</span> <em>Canadian Journal of Fisheries and Aquatic
Sciences</em> 76 (1): 123–35. <a href="https://doi.org/10.1139/cjfas-2017-0468" class="external-link">https://doi.org/10.1139/cjfas-2017-0468</a>.
</div>
</div>
<p>:::::::</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bryan Maitland, Morgan Sparks.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
